"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = attachCSSWatcher;
var CSSChangeEvent = new CustomEvent('css-change');

function attachCSSWatcher(callback) {
  CSSWatcher.addEventListener('css-change', function () {
    return callback();
  });
}

var CSSWatcher = new EventTarget();

(function watchCSS() {
  var CSS = getCSSText();
  setInterval(function () {
    var newCSS = getCSSText();
    if (CSS === newCSS) return;
    CSS = newCSS;
    CSSWatcher.dispatchEvent(CSSChangeEvent);
  }, 30);
  window.addEventListener('resize', function () {
    CSS = getCSSText();
    CSSWatcher.dispatchEvent(CSSChangeEvent);
  });
})();

function getCSSText() {
  var CSS = '';

  for (var i = 0; i < document.styleSheets.length; i++) {
    var sheet = document.styleSheets[i];

    for (var j = 0; j < sheet.rules.length; j++) {
      CSS += sheet.rules[j].cssText;
    }
  }

  return CSS;
}